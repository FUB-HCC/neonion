{% extends "base.html" %}

{% load staticfiles %}

{% block title %}Annotator{% endblock %}
{% block page_id %}annotator{% endblock %}

{% block left %}
    <div class="sidebar">
        {% include "navigation_annotator.html" %}
    </div>
{% endblock %}

{% block content %}
<div ng-controller="AnnotatorCtrl" data-ng-init="initialize({ docID:'{{ doc_id }}', userID:'{{ request.user.email }}', nerUrl:'{{ ner_url }}', nerAuth:'{{ ner_auth }}'})">
    <div class="annotator_menu" ng-cloak>
        <ul id="annotator_contributors" class="forms-list">
            <li ng-repeat="contrib in contributors | orderBy:'-updated'">
            {% verbatim %}
                <input
                type='checkbox'
                ng-model="contrib.showAnnotation"
                ng-click="toggleContributor(contrib)"/>
                <label style="background-color:{{ contrib.color }}">{{ contrib.user }} ({{contrib.updated | date: 'short'}})</label>
            {% endverbatim %}
            </li>
        </ul>
        <a ng-click="scrollToLastAnnotation()">
            <i class="fa fa-arrow-circle-down"></i> Scroll to last annotation
        </a>
    </div>
    <div>
        <div id="document-frame" class="panel panel-default">
            <div id="document-title" class="panel-heading big">{{ title }}</div>
            <div id="document-body" class="panel-body">
                <div>{% autoescape off %}{{ content }}{% endautoescape %}</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
    <script type="text/javascript" src="{% static 'js/annotator.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/annotator.neonion.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/annotator.ner.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/annotator.store.min.js' %}"></script>

    <script language="javascript">
        "use strict";

        $(document).ready(function () {
            $('#nav-anotate').click(function() {
                var span = $('#nav-anotate>span');
                if (!span.hasClass('fa-spin')) {
                    span.addClass('fa-spin');
                    Annotator._instances[0].plugins.NER.recognize({
                        success : function (data) {
                            span.removeClass('fa-spin');
                        },
                        error : function () {
                            span.removeClass('fa-spin');
                        }
                    });
                }
                return false;
            });

            /*$('#nav-fullscreen').click(function(){
                enableFullscreen( document.getElementById( 'document-frame' ) );
            });*/
        });

        /*
        // Find the right method, call on correct element
        function enableFullscreen(element) {
            if(element.requestFullscreen) {
            element.requestFullscreen();
            } else if(element.mozRequestFullScreen) {
            element.mozRequestFullScreen();
            } else if(element.webkitRequestFullscreen) {
            element.webkitRequestFullscreen();
            } else if(element.msRequestFullscreen) {
            element.msRequestFullscreen();
            }
        }
        */
    </script>
{% endblock %}